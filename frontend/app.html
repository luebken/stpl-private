<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="/css/bootstrap-3.3.7.min.css">
  <link rel="stylesheet" href="/css/bootstrap-theme-3.3.7.min.css">
  <link rel="stylesheet" href="/css/site.css">
  <!--
  <link href="data:image/x-icon;base64,AAABAAEAEBAQAAEABAAoAQAAFgAAACgAAAAQAAAAIAAAAAEABAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAADw8PAA7k8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiEAAAAAAAACIhAAAAAAAAIiIQAAAAAAACIiEAAAAAAAAiIhAAAAAAAAIiIQAAAAAAACIiEAAAAAAAAiIhAAAAARERIiIQAAACIiIiIiEAAAAiIiIiIhAAAAIiIQAAAAAAACIiEAAAAAAAAiIhAAAAAAAAIiIQAAAAAAACIiEAAP/wAAh/8AAIP/AADB/wAA4P8AAPB/AAD4PwAA/B8AAMAPAADABwAA4AMAAPB/AAD4PwAA/B8AAP4PAAD/BwAA"
    rel="icon" type="image/x-icon" />
    -->
</head>

<body>

  <div id="app">
    My Package: <input v-model="name" v-on:keyup.enter="query" autofocus> </br>
    <div id="details" v-if="got_result">
      Ecosystem: {{ platform }}, Latest release: {{ lastet_release }}, Link: <a v-bind:href="package_manager_url">{{ package_manager_url }}</a>
    </div>
    <div id="error" v-if="got_error">
      Upps. Couldn't find a result.
    </div>
  </div>

</body>

<!-- script libs -->

<script src="https://unpkg.com/vue"></script>
<script src="/js/jquery-1.12.4.min.js"></script>
<script src="/js/bootstrap-3.3.7.min.js"></script>
<script src="/js/amazon-cognito-sdk.v1.16.0.min.js"></script>
<script src="/js/amazon-cognito-identity.v1.16.0.min.js"></script>


<!-- my script-->
<script>
  var app = new Vue({
    el: '#app',
    data: {
      got_result: false,
      got_error: false,
      submit: "",
      platform: "",
      name: "",
      lastet_release: "",
      package_manager_url: ""
    },
    methods: {
      query: function () {
        that = this
        url = 'https://0m4mv2f1y8.execute-api.us-east-1.amazonaws.com/dev/component/npm/' + this.name
        console.log(url)
        fetch(url).then(response => {
          if (response.status == 200) {
            console.log("response ", response)
            response.json().then(function (json) {
              that.name = json.librariosio.name
              that.platform = json.librariosio.platform
              that.lastet_release = json.librariosio.latest_release_number
              that.package_manager_url = json.librariosio.package_manager_url
              that.got_result = true
              that.got_error = false
              console.log(json.librariosio)
            })
          } else { // 404
            that.got_result = false
            that.got_error = true
          }
        }, response => {
          that.got_result = false
          that.got_error = true
          console.log("error ", response)
        });
      }
    },
    mounted: function () {

    }
  })

</script>

</html>